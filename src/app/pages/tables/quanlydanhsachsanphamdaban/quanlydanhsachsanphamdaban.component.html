<nb-card>
  <nb-card-header>
    Danh Sách Sản Phẩm Đã Bán <a style="color: #2e61fa ;font-weight: 300; margin-left: 80px;" (click)="exportexcel()">
      Tải Danh Sách Sản Phẩm Đã Bán</a>

  </nb-card-header>

  <nb-card-body>



    <!-- <a style="color: #2e61fa ;font-weight: 300;" (click)="exportexcel()"> Tải Danh Sách Sản Phẩm</a> -->

    <!-- <br /> -->
   


    <p-table [tableStyleClass]="'kai-styled-table'"
    [tableStyle]="{'table-layout':'auto'}" [value]="data" id="excel-table" selectionMode="single" dataKey="madonhang" [paginator]="true"  [rows]="10" >
      <ng-template pTemplate="header" let-columns class=" text-primary">
        <tr>
          <th>Đơn hàng</th>
          <th>Tên sản phẩm <br><input type="text" style="height: 20px; width: 120px; border-radius: 5px;" (input)="filterdanhsachsanpham()"
            [(ngModel)]="tensp"></th>
          <th>Imei <br><input type="text" style="height: 20px; width: 120px; border-radius: 5px;" (input)="filterdanhsachsanpham()"
            [(ngModel)]="imeisp"> </th>
          <th *ngIf="role == 'admin'">Giá thu</th>
          <th>Giá tiền bán</th>
          <th>Số Lượng</th>
          <th>Trạng Thái</th>
          <th>Thời gian bảo hành</th>
          <th>Ngày bán <br><input type="date" style="margin-right: 5px;" [(ngModel)]="date1" (change)="change1()">-<input type="date"
            style="margin-left: 5px;" [(ngModel)]="date2" (change)="change2()"> <i class="fa fa-refresh"
            style="font-size:18px ;margin-left: 15px;" (click)="refresh()"></i></th>
        </tr>
      </ng-template>
    
      <ng-template pTemplate="body" let-sanpham>
       
        <tr [pSelectableRow]="sanpham">

          <td><a routerLink="/pages/tables/chitietdonhang"
              [queryParams]={id:[sanpham.madonhang]}>{{sanpham.madonhang}}</a></td>
          <td>{{sanpham.tensanpham}}</td>
          <td>{{sanpham.imei}}</td>
          <td *ngIf="role == 'admin'">{{sanpham.price | productPrice}}</td>
          <td>{{sanpham.giaban | productPrice}}</td>
          <td>{{sanpham.soluong}}</td>
          <td>{{sanpham.status}}</td>
          <td>{{sanpham.thoihanbaohanh}}</td>
          <td>{{sanpham.ngayban| date: 'dd/MM/yyyy'}}</td>
        </tr>
      </ng-template>
    </p-table>
  </nb-card-body>
</nb-card>